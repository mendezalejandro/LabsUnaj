<ng-container *ngIf="$operacion | async"></ng-container>
<div class="container form-container">
    <mat-card>
        <mat-card-header>
            <mat-card-title>{{'sign-change-password.title' | translate}}</mat-card-title>
            <mat-card-subtitle *ngIf="!cambioContrasenaEnviado">{{'sign-change-password.subtitle' | translate}}</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
            <ng-container *ngIf="!cambioContrasenaEnviado;else cambioContrasenaEnviadaTemplate">
            <form #form="ngForm">
                <div class="row mt-3">
                    <mat-form-field>
                        <mat-label>{{ 'sign-change-password.password' | translate }}</mat-label>
                        <mat-hint>{{'sign-up.password-hint'|translate}}</mat-hint>
                        <input alphaNumeric matInput #passwordInput="ngModel" ngModel name="password"
                            type="password" required
                            (ngModelChange)="validatePasswords(form)" minlength="8">
                        <mat-error
                            *ngIf="passwordInput.errors && passwordInput.errors['required']">{{'sign-change-password.password-error'|translate}}</mat-error>
                        <mat-icon matPrefix>password</mat-icon>
                    </mat-form-field>
                </div>
                <div class="row mt-3">
                    <mat-form-field>
                        <mat-label>{{ 'sign-change-password.confirm-password' | translate }}</mat-label>
                        <input alphaNumeric matInput ngModel #confirmPasswordInput="ngModel" name="confirmPassword" type="password"
                            placeholder="{{'sign-up.confirm-password-placeholder'|translate}}" required
                            (ngModelChange)="validatePasswords(form)" minlength="8">
                        <mat-error
                            *ngIf="confirmPasswordInput.errors && confirmPasswordInput.errors['required']">{{'sign-up.confirm-password-error'|translate}}</mat-error>
                        <mat-error
                            *ngIf="confirmPasswordInput.errors && confirmPasswordInput.errors['notMatching']">{{'sign-up.confirm-password-notmatch'|translate}}</mat-error>
                        <mat-icon matPrefix>password</mat-icon>
                    </mat-form-field>
                </div>
                <div class="row mt-4">
                    <div class="col">
                        <button mat-raised-button class="w-100" color="accent" [disabled]="!form.valid" (click)="cambiarContrasena(form)">{{'sign-change-password.button' |
                            translate}}</button>
                    </div>
                </div>
            </form>
            </ng-container>
            <ng-template #cambioContrasenaEnviadaTemplate>
                <div class="row ms-1 mt-2">
                    {{'sign-change-password.mensaje' | translate}}
                </div>
                <div class="row mt-4">
                    <div class="col">
                        <button mat-raised-button class="w-100" color="accent" (click)="toLogin()">{{'sign-change-password.back-to-login' |
                            translate}}</button>
                    </div>
                </div>
            </ng-template>
            
        </mat-card-content>
    </mat-card>

</div>